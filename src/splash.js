import { h, Component } from 'preact';
import { handleLaunchParameters } from './utils/queryParameters.js'
import './styles/splash.css'
import Client from './client.js'

export default class SplashView extends Component {
  pollInitialized = async () => {
    if (Client.client && Client.client.isInitialSyncComplete()) {
      this.props.setInitializationStage("initialized")
      handleLaunchParameters(this.props.logoutHandler) // clear query parameters
    } else {
      setTimeout(this.pollInitialized, 1000)
    }
  }

  componentDidMount() { this.pollInitialized() }

  render (props) {
    return <div id="splash-wrapper">
      <PopulusLogo />
      <div id="splash-loader">{props.initializationStage}...</div>
    </div>
  }
}

function PopulusLogo () {
  return <svg id="splash-logo" version="1.1" viewBox="0 0 43.752 7.5565" xmlns="http://www.w3.org/2000/svg">
 <g transform="translate(-35.949 -76.132)">
  <g stroke-width=".26458" aria-label="Populus">
   <path d="m37.314 76.132h1.397q0.67733 0 1.1642 0.24342t0.75141 0.70908q0.26458 0.45508 0.26458 1.0901 0 0.48683-0.1905 0.87841-0.1905 0.381-0.508 0.64558-0.3175 0.26458-0.71966 0.40216-0.40216 0.127-0.83608 0.09525-0.42333-0.03175-0.8255-0.24342v-0.10583t0.17992 0.03175q0.17992 0.02117 0.45508 0.01058 0.28575-0.02117 0.59266-0.11642 0.3175-0.10583 0.58208-0.35983 0.27516-0.254 0.41275-0.70908 0.03175-0.11642 0.05292-0.28575 0.02117-0.17992 0.01058-0.34925-0.01058-0.73025-0.381-1.1747-0.37042-0.4445-1.0477-0.4445h-1.2488t-0.03175-0.07408q-0.02117-0.08467-0.05292-0.15875-0.02117-0.08467-0.02117-0.08467zm0.13758 0v7.4083h-0.68791v-7.4083zm-0.65616 6.6357v0.77258h-0.84666v-0.10583t0.0635 0q0.07408 0 0.07408 0 0.27516 0 0.46566-0.1905 0.20108-0.20108 0.21167-0.47625zm0-5.8631h-0.03175q0-0.27517-0.20108-0.46566-0.20108-0.20108-0.47625-0.20108 0 0-0.0635 0t-0.0635 0l-0.01058-0.10583h0.84666zm0.62441 5.8631h0.03175q0.01058 0.27517 0.20108 0.47625 0.20108 0.1905 0.47625 0.1905 0 0 0.0635 0 0.07408 0 0.07408 0v0.10583h-0.84666z" style="font-variant-caps:normal;font-variant-east-asian:normal;font-variant-ligatures:normal;font-variant-numeric:normal" />
   <path d="m45.379 77.042q0.74083 0 1.3864 0.24342 0.65616 0.23283 1.143 0.67733 0.49742 0.4445 0.77258 1.0583 0.27517 0.60325 0.27517 1.3441t-0.27517 1.3547q-0.27516 0.60325-0.77258 1.0477-0.48683 0.4445-1.143 0.68791-0.64558 0.23283-1.3864 0.23283t-1.3864-0.23283q-0.64558-0.24342-1.143-0.68791-0.48683-0.4445-0.762-1.0477-0.27517-0.61383-0.27517-1.3547t0.27517-1.3441q0.27516-0.61383 0.762-1.0583 0.49742-0.4445 1.143-0.67733 0.64558-0.24342 1.3864-0.24342zm0 6.3288q0.78316 0 1.4182-0.381t1.0054-1.0583q0.37042-0.67733 0.37042-1.5663 0-0.89958-0.37042-1.5663-0.37042-0.67733-1.0054-1.0583-0.635-0.381-1.4182-0.381-0.77258 0-1.4076 0.381-0.635 0.381-1.0054 1.0583-0.37042 0.66675-0.37042 1.5663 0 0.889 0.37042 1.5663 0.37042 0.67733 1.0054 1.0583t1.4076 0.381z" style="font-variant-caps:normal;font-variant-east-asian:normal;font-variant-ligatures:normal;font-variant-numeric:normal" />
   <path d="m51.2 77.191h1.1747q0.74083 0 1.2806 0.22225 0.53975 0.21167 0.83608 0.62442 0.29633 0.40216 0.29633 0.96308 0 0.60325-0.27517 1.0372-0.26458 0.42333-0.70908 0.65616-0.4445 0.22225-0.98425 0.22225-0.53975-0.01058-1.0795-0.27516v-0.10583t0.16933 0.03175q0.17992 0.03175 0.45508 0.03175 0.27517-0.01058 0.58208-0.09525 0.30692-0.09525 0.5715-0.33867 0.27517-0.24342 0.43392-0.6985 0.04233-0.11642 0.05292-0.27516 0.02117-0.15875 0.02117-0.29633 0-0.64558-0.4445-1.016-0.4445-0.37042-1.2277-0.37042h-1.0372t-0.03175-0.07408q-0.02117-0.08467-0.05292-0.15875-0.03175-0.08467-0.03175-0.08467zm0.13758 0v6.35h-0.67733v-6.35zm-0.65616 5.6726 0.13758 0.67733h-0.92075v-0.10583t0.07408 0 0.07408 0q0.254 0 0.42333-0.16933 0.17992-0.16933 0.1905-0.40216zm0-5.0059h-0.02117q-0.01058-0.24342-0.1905-0.40217-0.16933-0.15875-0.42333-0.15875 0 0-0.07408 0t-0.07408 0v-0.10583h0.92075zm0.62441 5.0059h0.02117q0.01058 0.23283 0.17992 0.40216 0.17992 0.16933 0.43392 0.16933 0.01058 0 0.07408 0 0.07408 0 0.07408 0v0.10583h-0.92075z" style="font-variant-caps:normal;font-variant-east-asian:normal;font-variant-ligatures:normal;font-variant-numeric:normal" />
   <path d="m56.936 77.191v4.0005q0 1.0266 0.51858 1.6192 0.52916 0.59266 1.4393 0.59266 1.0054 0 1.5769-0.56092 0.58208-0.56092 0.58208-1.5346v-4.1169h0.48683v4.1169q0 1.1007-0.70908 1.7462-0.6985 0.635-1.9262 0.635-1.2171 0-1.9367-0.635-0.70908-0.635-0.70908-1.7357v-4.1275zm-0.65616 0v0.56092h-0.02117q-0.01058-0.1905-0.15875-0.3175-0.13758-0.13758-0.34925-0.13758 0 0-0.08467 0-0.07408 0-0.07408 0v-0.10583zm1.3229 0v0.10583t-0.08467 0q-0.07408 0-0.07408 0-0.20108 0-0.35983 0.13758-0.14817 0.127-0.14817 0.3175h-0.02117v-0.56092zm3.4713 0v0.56092h-0.02117q0-0.1905-0.14817-0.3175-0.14817-0.13758-0.35983-0.13758 0 0-0.08467 0-0.07408 0-0.07408 0v-0.10583zm1.1324 0v0.10583t-0.08467 0q-0.07408 0-0.07408 0-0.20108 0-0.34925 0.13758-0.14817 0.127-0.15875 0.3175h-0.02117v-0.56092z" style="font-variant-caps:normal;font-variant-east-asian:normal;font-variant-ligatures:normal;font-variant-numeric:normal" />
   <path d="m64.598 77.191v6.35h-0.67733v-6.35zm2.8469 6.0219-0.02117 0.32808h-2.8469v-0.32808zm0.59266-1.1853-0.58208 1.5134h-1.6087l0.35983-0.32808q0.52916 0 0.84666-0.14817 0.32808-0.15875 0.52916-0.42333 0.20108-0.27517 0.34925-0.61383zm-4.0957 0.83608 0.13758 0.67733h-0.92075v-0.10583t0.07408 0 0.07408 0q0.26458 0 0.43392-0.16933 0.16933-0.16933 0.17992-0.40216zm0.62442-4.9953v-0.67733h0.78316v0.10583t-0.0635 0-0.0635 0q-0.254 0-0.4445 0.16933-0.17992 0.15875-0.17992 0.40216zm-0.62442 0h-0.02117q-0.01058-0.24342-0.1905-0.40216-0.17992-0.16933-0.4445-0.16933 0 0-0.0635 0t-0.0635 0v-0.10583h0.78316z" style="font-variant-caps:normal;font-variant-east-asian:normal;font-variant-ligatures:normal;font-variant-numeric:normal" />
   <path d="m69.741 77.191v4.0005q0 1.0266 0.51858 1.6192 0.52916 0.59266 1.4393 0.59266 1.0054 0 1.5769-0.56092 0.58208-0.56092 0.58208-1.5346v-4.1169h0.48683v4.1169q0 1.1007-0.70908 1.7462-0.6985 0.635-1.9262 0.635-1.2171 0-1.9367-0.635-0.70908-0.635-0.70908-1.7357v-4.1275zm-0.65616 0v0.56092h-0.02117q-0.01058-0.1905-0.15875-0.3175-0.13758-0.13758-0.34925-0.13758 0 0-0.08467 0-0.07408 0-0.07408 0v-0.10583zm1.3229 0v0.10583t-0.08467 0q-0.07408 0-0.07408 0-0.20108 0-0.35983 0.13758-0.14817 0.127-0.14817 0.3175h-0.02117v-0.56092zm3.4713 0v0.56092h-0.02117q0-0.1905-0.14817-0.3175-0.14817-0.13758-0.35983-0.13758 0 0-0.08467 0-0.07408 0-0.07408 0v-0.10583zm1.1324 0v0.10583t-0.08467 0q-0.07408 0-0.07408 0-0.20108 0-0.34925 0.13758-0.14817 0.127-0.15875 0.3175h-0.02117v-0.56092z" style="font-variant-caps:normal;font-variant-east-asian:normal;font-variant-ligatures:normal;font-variant-numeric:normal" />
   <path d="m77.859 77.042q0.29633 0 0.51858 0.02117 0.22225 0.02117 0.381 0.05292 0.16933 0.02117 0.28575 0.0635 0.127 0.03175 0.22225 0.0635l0.01058 1.0477h-0.127q0-0.43392-0.29633-0.67733-0.29633-0.254-0.92075-0.254-0.52916 0-0.91016 0.29633-0.37042 0.28575-0.35983 0.70908 0 0.13758 0.03175 0.28575 0.04233 0.13758 0.127 0.27517 0.09525 0.13758 0.254 0.27517l2.1378 1.651q0.24342 0.20108 0.35983 0.51858 0.11642 0.30692 0.127 0.61383 0.01058 0.46566-0.24342 0.85725-0.254 0.39158-0.68791 0.62442-0.42333 0.22225-0.94191 0.22225-0.30692 0-0.66675-0.05292-0.34925-0.05292-0.65616-0.15875-0.30692-0.11642-0.508-0.28575-0.03175-0.14817-0.03175-0.37042 0-0.23283 0.03175-0.48683 0.04233-0.254 0.10583-0.45508h0.127q-0.04233 0.47625 0.13758 0.81491 0.17992 0.33866 0.52916 0.51858 0.34925 0.16933 0.81491 0.15875 0.65616-0.02117 1.0266-0.32808 0.381-0.3175 0.381-0.83608 0-0.254-0.09525-0.45508-0.08467-0.21167-0.28575-0.39158l-2.1167-1.6298q-0.29633-0.254-0.40217-0.56092t-0.10583-0.58208q0-0.43392 0.23283-0.78316t0.62442-0.55033q0.40216-0.21167 0.889-0.21167zm1.397 0.09525 0.01058 0.1905h-0.75142v-0.1905z" style="font-variant-caps:normal;font-variant-east-asian:normal;font-variant-ligatures:normal;font-variant-numeric:normal" />
  </g>
 </g>
</svg>
}
